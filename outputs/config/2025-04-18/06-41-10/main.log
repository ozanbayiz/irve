[2025-04-18 06:41:10,762][__main__][INFO] - Instantiating trainer: src.trainers.sae_trainer.SAETrainer
[2025-04-18 06:41:12,767][src.trainers.base_trainer][INFO] - Using device: cuda
[2025-04-18 06:41:12,768][__main__][INFO] - Trainer instantiated successfully.
[2025-04-18 06:41:12,768][__main__][INFO] - Starting trainer run...
[2025-04-18 06:41:12,768][src.trainers.base_trainer][INFO] - Initializing WandB run... Project: irve-hydra-refactor
[2025-04-18 06:41:13,783][src.trainers.base_trainer][INFO] - WandB Run Name: radiant-sun-8, ID: 3k5famj1
[2025-04-18 06:41:13,783][src.trainers.sae_trainer][INFO] - Setting up SAE Trainer components...
[2025-04-18 06:41:13,783][src.trainers.sae_trainer][INFO] - Instantiating dataset using config: src.datasets.datasets.FairFaceDataset
[2025-04-18 06:41:13,785][src.datasets.datasets][INFO] - Initializing FairFaceDataset: path=./data/fairface_latent_stratified.hdf5, mode=training, requested_labels=[]
[2025-04-18 06:41:13,787][src.datasets.datasets][INFO] - Dataset contains 11842 items in mode 'training'
[2025-04-18 06:41:13,788][src.datasets.datasets][INFO] - Labels explicitly disabled. Will return features only.
[2025-04-18 06:41:13,789][src.datasets.datasets][INFO] - Initializing FairFaceDataset: path=./data/fairface_latent_stratified.hdf5, mode=validation, requested_labels=[]
[2025-04-18 06:41:13,791][src.datasets.datasets][INFO] - Dataset contains 2666 items in mode 'validation'
[2025-04-18 06:41:13,791][src.datasets.datasets][INFO] - Labels explicitly disabled. Will return features only.
[2025-04-18 06:41:13,791][src.trainers.sae_trainer][INFO] - Datasets created: Train size=11842, Val size=2666
[2025-04-18 06:41:13,792][src.trainers.sae_trainer][INFO] - Train Dataloader: 741 batches, 4 workers, pin_memory=True
[2025-04-18 06:41:13,792][src.trainers.sae_trainer][INFO] - Validation Dataloader: 167 batches
[2025-04-18 06:41:13,792][src.trainers.sae_trainer][INFO] - Instantiating model: src.models.sparse_autoencoder.SparseAutoencoder
[2025-04-18 06:41:13,792][src.trainers.sae_trainer][INFO] - Using input_size from config: 443136
[2025-04-18 06:42:52,080][src.trainers.sae_trainer][ERROR] - Setup failed. Aborting run.
Traceback (most recent call last):
  File "/home/ozanbayiz/irve/src/trainers/sae_trainer.py", line 217, in run
    self._setup()
    ~~~~~~~~~~~^^
  File "/home/ozanbayiz/irve/src/trainers/sae_trainer.py", line 115, in _setup
    self.model = hydra.utils.instantiate(self.cfg.model).to(self.device)
                 ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~^^^^^^^^^^^^^
  File "/home/ozanbayiz/miniforge3/envs/irve/lib/python3.13/site-packages/torch/nn/modules/module.py", line 1343, in to
    return self._apply(convert)
           ~~~~~~~~~~~^^^^^^^^^
  File "/home/ozanbayiz/miniforge3/envs/irve/lib/python3.13/site-packages/torch/nn/modules/module.py", line 903, in _apply
    module._apply(fn)
    ~~~~~~~~~~~~~^^^^
  File "/home/ozanbayiz/miniforge3/envs/irve/lib/python3.13/site-packages/torch/nn/modules/module.py", line 903, in _apply
    module._apply(fn)
    ~~~~~~~~~~~~~^^^^
  File "/home/ozanbayiz/miniforge3/envs/irve/lib/python3.13/site-packages/torch/nn/modules/module.py", line 930, in _apply
    param_applied = fn(param)
  File "/home/ozanbayiz/miniforge3/envs/irve/lib/python3.13/site-packages/torch/nn/modules/module.py", line 1329, in convert
    return t.to(
           ~~~~^
        device,
        ^^^^^^^
        dtype if t.is_floating_point() or t.is_complex() else None,
        ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
        non_blocking,
        ^^^^^^^^^^^^^
    )
    ^
torch.OutOfMemoryError: CUDA out of memory. Tried to allocate 27.05 GiB. GPU 0 has a total capacity of 39.50 GiB of which 7.70 GiB is free. Process 1390953 has 4.28 GiB memory in use. Including non-PyTorch memory, this process has 27.45 GiB memory in use. Of the allocated memory 27.05 GiB is allocated by PyTorch, and 1.94 MiB is reserved by PyTorch but unallocated. If reserved but unallocated memory is large try setting PYTORCH_CUDA_ALLOC_CONF=expandable_segments:True to avoid fragmentation.  See documentation for Memory Management  (https://pytorch.org/docs/stable/notes/cuda.html#environment-variables)
[2025-04-18 06:42:53,643][__main__][INFO] - Trainer run finished.
